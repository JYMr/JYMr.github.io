webpackJsonp([19],{"+De7":function(e,t,i){"use strict";var o=i("AA3o"),r=i.n(o),n=i("xSur"),s=i.n(n),l=i("LJJC"),a=new(function(){function e(){r()(this,e)}return s()(e,[{key:"getRole",value:function(e){return Object(l.c)("/merchant/supplier/role/list",e).then(function(e){return e})}},{key:"insertRole",value:function(e){return Object(l.c)("/merchant/supplier/role/insert",e).then(function(e){return e})}},{key:"editRole",value:function(e){return Object(l.c)("/merchant/supplier/role/update",e).then(function(e){return e})}},{key:"getRolePermissionByLogin",value:function(e){return Object(l.c)("/merchant/supplier/role/getRolePermissionByLogin",e).then(function(e){return e})}},{key:"getRolePermissionByRoleid",value:function(e){return Object(l.c)("/merchant/supplier/role/getRolePermissionByRoleid/"+e).then(function(e){return e})}},{key:"updateRolePermission",value:function(e){return Object(l.c)("/merchant/supplier/role/updateRolePermission",e).then(function(e){return e})}},{key:"getuserlist",value:function(){return Object(l.c)("/merchant/supplier/user/list").then(function(e){return e})}},{key:"insertuser",value:function(e){return Object(l.c)("/merchant/supplier/user/insert",e).then(function(e){return e})}},{key:"updateuser",value:function(e){return Object(l.c)("/merchant/supplier/user/update",e).then(function(e){return e})}},{key:"resetPassword",value:function(e){return Object(l.c)("/merchant/supplier/user/resetPassword/"+e).then(function(e){return e})}},{key:"freeze",value:function(e){return Object(l.c)("/merchant/supplier/user/freeze/"+e).then(function(e){return e})}},{key:"unfreeze",value:function(e){return Object(l.c)("/merchant/supplier/user/unfreeze/"+e).then(function(e){return e})}}]),e}());t.a=a},"4IAQ":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("4YfN"),r=i.n(o),n=i("HzJ8"),s=i.n(n),l=i("+De7"),a={data:function(){return{editMode:!1,newMode:!0,dialogVisible:!1,RoleListLoading:!1,dialogTitle:"新建角色",editRoleform:{roleName:"",roleDesc:""},thisEditRoleName:"",RoleList:[],defaultProps:{children:"children",label:"permission_desc"},roleId:"",permissiondata:[],permissionDefaultChoose:[],permissionChoose:[]}},mounted:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;this.RoleListLoading=!0,l.a.getRole().then(function(t){e.RoleListLoading=!1,e.RoleList=t})},savesole:function(){var e=this;this.$refs.editRoleform.validate(function(t){t&&(e.newMode?(e.editRoleform.roleId&&delete e.editRoleform.roleId,l.a.insertRole(e.editRoleform).then(function(t){e.$message.success("添加角色成功"),e.dialogVisible=!1,e.getRoleList()})):l.a.editRole(e.editRoleform).then(function(t){e.$message.success("修改角色成功"),e.dialogVisible=!1,e.getRoleList()}))})},getRoleData:function(e){var t=this;l.a.getRolePermissionByRoleid(e).then(function(e){t.permissiondata=t.Permissionformatter(e),t.permissionChoose=t.permissionDefaultChoose=t.PermissionCheck(t.permissiondata)})},newrole:function(){this.dialogVisible=!0},editRole:function(e,t,i){this.dialogVisible=!0,this.newMode=!1,this.editRoleform={roleId:e,roleName:t,roleDesc:i}},editPermission:function(e){this.editMode=!0,this.getRoleData(e),this.roleId=e},savePermission:function(){var e=this;l.a.updateRolePermission({permissionIds:this.permissionChoose.toString(),roleId:this.roleId}).then(function(t){e.$message.success("保存角色权限成功"),e.editMode=!1})},initform:function(){this.newMode=!0,this.$refs.editRoleform.resetFields()},Permissionformatter:function(e){for(var t=[],i={},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"permission_id",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"permission_parent_id",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"children",s=0,l=0,a=e.length;s<a;s++)i[e[s][o]]=e[s];for(;l<a;l++){var c=e[l],u=i[c[r]];u?(!u[n]&&(u[n]=[]),u[n].push(c)):t.push(c)}return t},PermissionCheck:function(e){var t=[];return function e(i){var o=!0,r=!1,n=void 0;try{for(var l,a=s()(i);!(o=(l=a.next()).done);o=!0){var c=l.value;1===c.permission_check&&t.push(parseInt(c.permission_id)),c.children&&e(c.children)}}catch(e){r=!0,n=e}finally{try{!o&&a.return&&a.return()}finally{if(r)throw n}}}(this.handleParent(e)),t},handleParent:function(e){var t=this;return e.map(function(e){var i=e.permission_check,o=e.children;if(o){o=t.handleParent(o);var n=!0,l=!1,a=void 0;try{for(var c,u=s()(o);!(n=(c=u.next()).done);n=!0){if(0===c.value.permission_check){i=0;break}}}catch(e){l=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(l)throw a}}}return r()({},e,{children:o,permission_check:i})})},treecheck:function(e,t){this.permissionChoose=t.checkedKeys.concat(t.halfCheckedKeys)}},watch:{newMode:function(e,t){this.dialogTitle=e?"新建角色":"编辑角色"}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("AutoBreadcrumb"),e._v(" "),i("div",{staticClass:"Role content-box"},[i("el-row",[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"role-list"},[i("h4",[e._v("\n                        角色列表\n                        "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.newrole}},[e._v("新增角色")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.RoleListLoading,expression:"RoleListLoading"}],attrs:{data:e.RoleList,border:""}},[i("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),e._v(" "),i("el-table-column",{attrs:{label:"角色说明",prop:"roleDesc"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"mini"},on:{click:function(i){e.editPermission(t.row.roleId)}}},[e._v("\n                                    编辑权限\n                                    "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(i){e.editRole(t.row.roleId,t.row.roleName,t.row.roleDesc)}}},[e._v("编辑角色")])],1)],1)]}}])})],1)],1)]),e._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"modal-tree"},[i("h4",[e._v("\n                        菜单模块"),e.thisEditRoleName?i("span",{staticClass:"merber"},[e._v(e._s(e.thisEditRoleName))]):e._e(),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],attrs:{type:"primary",size:"mini"},on:{click:e.savePermission}},[e._v("保存")])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.editMode,expression:"!editMode"}],staticClass:"modal-text"},[e._v("请从左边选择角色进行权限编辑操作")]),e._v(" "),i("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],attrs:{props:e.defaultProps,data:e.permissiondata,"default-checked-keys":e.permissionDefaultChoose,"node-key":"permission_id","default-expand-all":"","show-checkbox":""},on:{check:e.treecheck}})],1)])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.initform}},[i("el-form",{ref:"editRoleform",attrs:{model:e.editRoleform,"label-width":"80px"}},[i("el-row",[i("el-col",{attrs:{span:16,offset:4}},[i("el-form-item",{attrs:{label:"角色名称",prop:"roleName",rules:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}},[i("el-input",{model:{value:e.editRoleform.roleName,callback:function(t){e.$set(e.editRoleform,"roleName",t)},expression:"editRoleform.roleName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色说明",prop:"roleDesc",rules:[{required:!0,message:"请输入角色说明",trigger:"blur"}]}},[i("el-input",{model:{value:e.editRoleform.roleDesc,callback:function(t){e.$set(e.editRoleform,"roleDesc",t)},expression:"editRoleform.roleDesc"}})],1)],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.savesole}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var u=i("vSla")(a,c,!1,function(e){i("v+WI")},null,null);t.default=u.exports},"v+WI":function(e,t){}});