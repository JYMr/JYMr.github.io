webpackJsonp([15],{"5Cxr":function(i,t){},"81XI":function(i,t){},"8rls":function(i,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("T+zv"),n=e("w3CS"),o={props:{visible:{type:Boolean,required:!0},id:{type:String,value:void 0}},data:function(){return{editMode:!1,titleArr:["添加配送区域","编辑配送区域"],dialogVisible:!1,distributionform:{distributionName:"",distributionAmount:0,distributionUnderAmount:"",distributionFreeShipping:"",distributionRecommend:"",areaList:[]},defaultProps:{children:"children",label:"regionName"},loading:!1,areadata:[],validator:n.a}},methods:{init:function(){var i=this;setTimeout(function(){i.$refs.form.resetFields(),i.getProvince(i.id),i.distributionform.distributionId,""!==i.id?(i.editMode=!0,i.getSupplierDistributionById(i.id)):i.editMode=!1},0)},getSupplierDistributionById:function(i){var t=this;r.a.getSupplierDistributionById(i).then(function(i){i.areaList&&i.areaList.length>0&&(i.areaList=i.areaList.map(function(i){return i.distributionArea})),t.distributionform=i})},save:function(){var i=this;this.$refs.form.validate(function(t){if(t){var e=i.distributionform;e.distributionAmount=parseFloat(e.distributionAmount),e.areaList=e.areaList.map(function(i){return{distributionArea:i,distributionId:e.distributionId||""}}),r.a.addSupplierDistribution(e).then(function(t){i.$message.success("保存成功"),i.dialogVisible=!1,i.$emit("saveEvent")})}})},treecheck:function(i,t,e,r){this.distributionform.areaList=t.checkedKeys},getProvince:function(){var i=this,t=void 0===this.id||""===this.id?-1:this.id;this.loading=!0,r.a.getSupplierDistributionAreaByid(t).then(function(t){i.areadata=i.formatter(t),i.loading=!1})},formatter:function(i){for(var t=[],e={},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regionId",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"regionParentId",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"children",s=0,a=0,u=i.length;s<u;s++)e[i[s][r]]=i[s];for(;a<u;a++){var d=i[a],l=e[d[n]];l?(!l[o]&&(l[o]=[]),l[o].push(d)):t.push(d)}return t}},watch:{visible:function(i,t){this.dialogVisible=i},dialogVisible:function(i,t){i||this.$emit("update:visible",i)}}},s={render:function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("el-dialog",{attrs:{title:i.titleArr[i.editMode?1:0],visible:i.dialogVisible,width:"60%"},on:{"update:visible":function(t){i.dialogVisible=t},open:i.init}},[e("el-form",{ref:"form",attrs:{model:i.distributionform,"label-width":"180px"}},[e("el-row",[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"地区备注",prop:"distributionName",rules:[{required:!0,message:"请输入地区备注",trigger:"blur"}]}},[e("el-input",{model:{value:i.distributionform.distributionName,callback:function(t){i.$set(i.distributionform,"distributionName",t)},expression:"distributionform.distributionName"}})],1),i._v(" "),e("el-form-item",{attrs:{label:"起配金额",prop:"distributionAmount",rules:[{required:!0,message:"请输入起配金额",trigger:"blur"},{validator:i.validator.price,trigger:"blur"}]}},[e("el-input",{model:{value:i.distributionform.distributionAmount,callback:function(t){i.$set(i.distributionform,"distributionAmount",t)},expression:"distributionform.distributionAmount"}})],1),i._v(" "),e("el-form-item",{attrs:{label:"满包金额",prop:"distributionFreeShipping",rules:[{required:!0,message:"请输入满包金额",trigger:"blur"},{validator:i.validator.price,trigger:"blur"}]}},[e("el-input",{model:{value:i.distributionform.distributionFreeShipping,callback:function(t){i.$set(i.distributionform,"distributionFreeShipping",i._n(t))},expression:"distributionform.distributionFreeShipping"}})],1),i._v(" "),e("el-form-item",{attrs:{label:"未满包邮的运费",prop:"distributionUnderAmount",rules:[{required:!0,message:"请输入未满起配金额加收运费",trigger:"blur"},{validator:i.validator.price,trigger:"blur"}]}},[e("el-input",{model:{value:i.distributionform.distributionUnderAmount,callback:function(t){i.$set(i.distributionform,"distributionUnderAmount",i._n(t))},expression:"distributionform.distributionUnderAmount"}})],1),i._v(" "),e("el-form-item",{attrs:{label:"配送说明",prop:"distributionRecommend",rules:[{required:!0,message:"请输入配送说明",trigger:"blur"}]}},[e("el-input",{attrs:{type:"textarea",rows:3},model:{value:i.distributionform.distributionRecommend,callback:function(t){i.$set(i.distributionform,"distributionRecommend",t)},expression:"distributionform.distributionRecommend"}})],1)],1),i._v(" "),e("el-col",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],attrs:{span:11,offset:2}},[e("div",{staticClass:"city-select"},[e("el-form-item",{attrs:{"label-width":"0",prop:"areaList",rules:[{required:!0,message:"请选择配送范围",trigger:"change"}]}},[e("span",[i._v("配送范围")]),i._v(" "),e("el-tree",{attrs:{props:i.defaultProps,data:i.areadata,"default-checked-keys":i.distributionform.areaList,"node-key":"regionId","show-checkbox":""},on:{check:i.treecheck}})],1)],1)])],1)],1),i._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){i.dialogVisible=!1}}},[i._v("取 消")]),i._v(" "),e("el-button",{attrs:{type:"primary",disabled:i.loading},on:{click:i.save}},[i._v("确 定")])],1)],1)},staticRenderFns:[]};var a={data:function(){return{DistributionList:[],visible:!1,Distributionid:"",loading:!1}},mounted:function(){this.getDistributionList()},methods:{getDistributionList:function(){var i=this;this.loading=!0,r.a.getSupplierDistributionList().then(function(t){i.loading=!1,i.DistributionList=t})},editdistribution:function(i){this.showDialog(i)},adddistribution:function(){this.Distributionid="",this.showDialog()},deldistribution:function(i){var t=this;this.$confirm("是否删除此配送区域?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.deleteSupplierDistribution(i).then(function(i){t.$message.success("删除成功"),t.getDistributionList()})}).catch(function(i){})},showDialog:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.Distributionid=i,this.visible=!0}},components:{DistributionEditor:e("vSla")(o,s,!1,function(i){e("5Cxr")},null,null).exports}},u={render:function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",[e("AutoBreadcrumb"),i._v(" "),e("div",{staticClass:"Distribution content-box"},[e("h3",[i._v("配送设置")]),i._v(" "),i.DistributionList.length>0?e("div",{directives:[{name:"loading",rawName:"v-loading",value:i.loading,expression:"loading"}],staticClass:"distribution-content"},[e("div",{staticClass:"distribution-list"},i._l(i.DistributionList,function(t,r){return e("div",{key:"DistributionList_"+r,staticClass:"distribution-item"},[e("h4",[e("i",{staticClass:"icon el-icon-location"}),i._v("\n                        "+i._s(t.distributionName)+"\n                        "),e("i",{staticClass:"el-icon-delete right",on:{click:function(e){i.deldistribution(t.distributionId)}}}),i._v(" "),e("i",{staticClass:"el-icon-edit right",on:{click:function(e){i.editdistribution(t.distributionId)}}})]),i._v(" "),e("div",{staticClass:"text"},[e("span",[i._v("起配金额")]),i._v(" "),e("span",[i._v(i._s(i._f("price")(t.distributionAmount))+" | "+i._s(1==t.distributionType?"起配":"包邮"))])]),i._v(" "),e("div",{staticClass:"text"},[e("span",[i._v("未满起配金额加运费")]),i._v(" "),e("span",[i._v(i._s(i._f("price")(t.distributionUnderAmount)))])]),i._v(" "),e("div",{staticClass:"text full"},[e("span",[i._v("起配范围")]),i._v(" "),e("span",[i._v(i._s(t.distributionRecommend))])])])}))]):e("div",{staticClass:"distribution-empty"},[i._v("\n            暂无配送区域信息\n        ")]),i._v(" "),e("div",{staticClass:"btn-submit"},[e("el-button",{attrs:{type:"primary"},on:{click:i.adddistribution}},[i._v("添加按区域配送")])],1)]),i._v(" "),e("DistributionEditor",{attrs:{visible:i.visible,id:i.Distributionid},on:{"update:visible":function(t){i.visible=t},saveEvent:i.getDistributionList}})],1)},staticRenderFns:[]};var d=e("vSla")(a,u,!1,function(i){e("81XI")},null,null);t.default=d.exports}});