webpackJsonp([10],{"1pyD":function(e,t){},bND5:function(e,t){e.exports=function(e,t,a){var l=new Blob([e],{type:a||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(l,t);else{var o=window.URL.createObjectURL(l),n=document.createElement("a");n.style.display="none",n.href=o,n.setAttribute("download",t),void 0===n.download&&n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(o)}}},bQzH:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("aA9S"),o=a.n(l),n=a("KM1H"),i=(a("iClD"),{props:{tableData:{type:Object,required:!0},type:{type:Number,required:!0}},data:function(){return{}},methods:{Reapply:function(e){var t=this;this.$confirm("是否重新申请审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.Reapply(e).then(function(e){t.$message.success("操作成功"),t.$emit("reload")})}).catch(function(){})},delapply:function(e){var t=this;this.$confirm("是否删除该商品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.delapply(e).then(function(e){t.$message.success("删除成功"),t.$emit("reload")})}).catch(function(){})},repealApply:function(e){var t=this;this.$confirm("是否撤销申请该商品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.repealApply(e).then(function(e){t.$message.success("撤销成功"),t.$emit("reload")})}).catch(function(){})},paginationChange:function(e){this.$emit("paginationChange",e)},paginationSizeChange:function(e){this.$emit("paginationSizeChange",e)},LinkTo:function(e){this.$router.push({path:e})}}}),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ApplicationTable"},[a("el-table",{attrs:{data:e.tableData.list,border:""}},[a("el-table-column",{attrs:{label:"商品图片"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.commoditysUrl.length>0?[a("img",{attrs:{src:e.row.commoditysUrl[0].url,alt:""}})]:void 0}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"commodityEncoding",label:"商品编码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"manufacturers",label:"厂家"}}),e._v(" "),a("el-table-column",{attrs:{prop:"approvalNumber",label:"批准文号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"category",label:"商品分类"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dosageForm",label:"剂型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"specification",label:"包装规格"}}),e._v(" "),a("el-table-column",{attrs:{label:"提交时间",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e._f("formatDate")(t.row.createTime))+"\n            ")]}}])}),e._v(" "),2==e.type?a("el-table-column",{attrs:{prop:"applyVo.applyTime",label:"审核时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.applyVo?a("span",[e._v(e._s(e._f("formatDate")(t.row.applyVo.applyTime)))]):e._e()]}}])}):e._e(),e._v(" "),3==e.type?a("el-table-column",{attrs:{prop:"goodsname",label:"审核状态/时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.applyState?a("div",[e._v("未审核")]):e._e(),e._v(" "),1==t.row.applyState?a("div",[e._v("审核通过")]):e._e(),e._v(" "),2==t.row.applyState?a("div",[e._v("审核失败")]):e._e(),e._v(" "),t.row.applyVo?a("div",[e._v(e._s(e._f("formatDate")(t.row.applyVo.applyTime)))]):e._e()]}}])}):e._e(),e._v(" "),3==e.type?a("el-table-column",{attrs:{prop:"applyVo.result",label:"原因"}}):e._e(),e._v(" "),1==e.type?a("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"mini"},on:{click:function(a){e.LinkTo("/Product/Application/NewProduct?id="+t.row.id)}}},[e._v("\n                    编辑\n                    "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("div",{on:{click:function(a){e.repealApply(t.row.applyId)}}},[e._v("撤销申请")])])],1)],1)]}}])}):e._e(),e._v(" "),3==e.type?a("el-table-column",{attrs:{prop:"goodsname",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"mini"},on:{click:function(a){e.Reapply(t.row.id)}}},[e._v("\n                    重新申请\n                    "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("div",{on:{click:function(a){e.delapply(t.row.id)}}},[e._v("删除")])])],1)],1)]}}])}):e._e()],1),e._v(" "),a("div",{staticClass:"table-pagination"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next",total:Number(e.tableData.total),"current-page":e.tableData.pageNum,"page-sizes":[10,20,30,50,100],"prev-text":"上一页","next-text":"下一页"},on:{"current-change":e.paginationChange,"size-change":e.paginationSizeChange}})],1)],1)},staticRenderFns:[]};var s=a("vSla")(i,r,!1,function(e){a("1pyD")},null,null).exports,p=a("5VHC"),c=a("Leza"),d=(a("bND5"),{data:function(){return{loadingTab:!1,UploadVisible:!1,categorydata:[],props:{label:"name",value:"id",children:"children"},tableData:{},searchform:{},status:0,excelFile:null,pageVo:{pageNo:1,size:10},UploadUrl:c.b,Headers:c.a}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var e=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.status;this.loadingTab=!0;var t=o()(this.searchform,{pageVo:this.pageVo});t=o()(t,{applyState:this.status}),n.a.getapplysList(t).then(function(t){e.tableData=t,e.loadingTab=!1})},downloadExcel:function(){var e=o()(this.searchform,{pageVo:this.pageVo});e=o()(e,{applyState:this.status}),n.a.importDrug(e).then(function(e){var t=new Blob([e],{type:"application/vnd.ms-excel;charset=utf-8"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="药品数据导出"+(new Date).getTime()+".xlsx",l.click()})},toggleTab:function(e){var t=parseInt(e.name);this.status=t,this.getTableData()},paginationChange:function(e){this.pageVo.pageNo=parseInt(e),this.getTableData()},paginationSizeChange:function(e){this.pageVo={pageNo:1,size:parseInt(e)},this.getTableData()},applyUpload:function(){this.UploadVisible=!0},handleItemChange:function(e){this.getCategoryChild(e)},handleChange:function(e){3===e.length&&(this.searchform.category=e[2])},beforeUpload:function(e){var t="application/vnd.ms-excel"===e.type,a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type;return t||a||this.$message.error("上传的文件只能是 XLS 或 XLSX 格式!"),t||a},downtemplateFile:function(){window.open("https://kzj-b2b.oss-cn-shenzhen.aliyuncs.com/128214925283799040.xlsx")},handleExcel:function(e){this.excelFile=e.file},UploadDrugByExcel:function(){var e=this;null!=this.excelFile?n.a.importDrugByExcel(this.excelFile).then(function(t){e.$message.success("导入成功"),e.getTableData(),e.UploadVisible=!1}).catch(function(t){if(""!==t.data){var a=t.data.split(",");e.$message.error("第"+a[0]+"行, 第"+a[1]+"列格式错误!")}else e.$message.error(t)}):this.$message.error("请选择需要导入的Excel文件")},handleexceed:function(){this.$message.error("超出个数限制，只能上传一个文件")},LinkTo:function(e){this.$router.push({path:e})}},components:{ApplicationTable:s,SelectInput:p.a}}),u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("AutoBreadcrumb"),e._v(" "),a("div",{staticClass:"Application content-box"},[a("el-form",{ref:"form",attrs:{model:e.searchform,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{lg:6}},[a("SelectInput",{attrs:{selectList:[{label:"药品编码",key:"commodityEncoding"},{label:"商品名称",key:"name"},{label:"批准文号",key:"approvalNumber"},{label:"厂家",key:"manufacturers"}]},model:{value:e.searchform,callback:function(t){e.searchform=t},expression:"searchform"}})],1),e._v(" "),a("el-col",{attrs:{lg:9}},[a("el-form-item",{attrs:{label:"申请时间"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"timestamp"},model:{value:e.searchform.applyStartTime,callback:function(t){e.$set(e.searchform,"applyStartTime",t)},expression:"searchform.applyStartTime"}})],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"timestamp","default-time":"23:59:59"},model:{value:e.searchform.applyEndTime,callback:function(t){e.$set(e.searchform,"applyEndTime",t)},expression:"searchform.applyEndTime"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:5}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("搜索")]),e._v(" "),a("el-button",{on:{click:e.downloadExcel}},[e._v("导出")])],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{lg:6}},[a("el-form-item",{attrs:{label:"商品分类"}},[a("el-input",{attrs:{placeholder:"输入商品分类"},model:{value:e.searchform.category,callback:function(t){e.$set(e.searchform,"category",t)},expression:"searchform.category"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{lg:24}},[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.LinkTo("/Product/Application/NewProduct")}}},[e._v("新增新品")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.applyUpload}},[e._v("批量导入")])],1)],1)],1),e._v(" "),a("el-tabs",{attrs:{type:"card",value:"0"},on:{"tab-click":e.toggleTab}},[a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTab,expression:"loadingTab"}],attrs:{label:"待审核",name:"0"}},[a("ApplicationTable",{attrs:{tableData:e.tableData,type:1},on:{paginationChange:e.paginationChange,paginationSizeChange:e.paginationSizeChange,reload:e.getTableData}})],1),e._v(" "),a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTab,expression:"loadingTab"}],attrs:{label:"审核不通过",name:"2",lazy:!0}},[a("ApplicationTable",{attrs:{tableData:e.tableData,type:3},on:{paginationChange:e.paginationChange,paginationSizeChange:e.paginationSizeChange,reload:e.getTableData}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量导入新品",visible:e.UploadVisible},on:{"update:visible":function(t){e.UploadVisible=t}}},[a("el-form",{ref:"formUpload",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"批量导入"}},[a("el-upload",{attrs:{drag:"",action:e.UploadUrl,"before-upload":e.beforeUpload,"http-request":e.handleExcel,"on-exceed":e.handleexceed,limit:1}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx/xls文件, 且药品每个字段必填")])])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:e.downtemplateFile}},[e._v("导入模板文件下载")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.UploadVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.UploadDrugByExcel}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("vSla")(d,u,!1,function(e){a("yMxH")},null,null);t.default=m.exports},yMxH:function(e,t){}});